<!DOCTYPE html> 
<html> 
  
<head> 
    <title> 
        How to detect browser or tab closing 
    </title> 
</head> 
  
<body> 
    <h1 style="color: green"> 
        GeeksforGeeks 
    </h1> 
      
    <b>Detect browser or tab closing</b> 
      
    <p> 
        The beforeunload function is triggered 
        just before the browser or tab is to be 
        closed or the page is to be reloaded. 
        Modern browsers require some interaction 
        with the page, otherwise the dialog box 
        is not shown. 
    </p> 
      
    <form> 
        <textarea placeholder = "Trigger an  
         interaction by writing something here"> 
        </textarea> 
    </form> 
<script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.js"></script>
   <script type="text/javascript">
var areYouReallySure = false;
function areYouSure() {
    if(allowPrompt){
        if (!areYouReallySure && true) {
            areYouReallySure = true;
            var order_id=1;
              $.ajax({
  url: 'ongodmed.com/user/vivek/', //php          
  data: {order_id: order_id,},
  dataType: 'json', //data format
  method: "POST",
  success: function (callDetails) {
         if(callDetails.status){
             localStorage.removeItem("runningchatVal");
            window.location.href = "<?= base_url() ?>chat-with-astrologer/";
         }
      }
    });
            var confMessage = "***************************************\n\n W A I T !!! \n\nBefore leaving our site, follow CodexWorld for getting regular updates on Programming and Web Development.\n\n\nCLICK THE *CANCEL* BUTTON RIGHT NOW\n\n***************************************";
            return confMessage;
        }
    }else{
        allowPrompt = true;
    }
}

var allowPrompt = true;
window.onbeforeunload = areYouSure;
</script> 
</body> 
  
</html>        